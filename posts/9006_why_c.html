<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8' />
<meta name='viewport' content='width=device-width, initial-scale=1' />
<title>Why I Write C</title>
<meta name='description' content='A handmade journey into game engines' />
<meta itemprop='name' content='Why I Write C'>
<meta itemprop='description' content='A handmade journey into game engines'>
<meta itemprop='image' content='godrays_04.png'>
<meta property='og:title' content='Why I Write C' />
<meta property='og:description' content='A handmade journey into game engines' />
<meta property='og:type' content='website' />
<meta property='og:url' content='null' />
<meta property='og:site_name' content='Nick Aversano' />
<meta property='og:locale' content='en_us' />
<meta name='twitter:card' content='summary' />
<meta name='twitter:title' content='Why I Write C' />
<meta name='twitter:description' content='A handmade journey into game engines' />
<meta name='twitter:image' content='godrays_04.png' />
<meta name='twitter:site' content='@nickaversano' />
<meta name='theme-color' content='#000000' />
<meta name='msapplication-TileColor' content='#000000' />
<link rel='shortcut icon' href='/favicon.png' sizes='32x32' />
<style type='text/css'>*{margin:0}*,*:before,*:after{box-sizing:border-box}html,body{height:100%}img,video{display:block;max-width:100%;height:auto;margin:0 auto}img{width:100%}input,button,textarea,select{font:inherit}h1,h2,h3,h4,h5,h6,p{padding:0;overflow-wrap:break-word}svg{fill:currentColor}:root{--black:#000;--white:#fff;--gray:#bbb;--gray-light:rgba(255,255,255,0.25);--white-light:rgba(255,255,255,0.1);--black-light:rgba(0,0,0,0.1);--bg:var(--black);--color:var(--white);--highlight:var(--white-light);--accent:#afaffc}.invert{--bg:var(--white);--color:var(--black);--highlight:var(--black-light);--gray:#555;--gray-light:rgba(0,0,0,0.25);background:var(--bg);color:var(--color)}html{font-size:16px;font-weight:400;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;line-height:1.5;-webkit-font-smoothing:antialiased}body{background:var(--bg);color:var(--color);min-width:320px}.load *{transition:opacity 200ms,background 200ms,color 200ms}a{color:inherit;text-decoration:none;cursor:pointer}a:not(.no-hover):hover{opacity:0.5}p{margin:1rem 0}hr{margin:4rem 0;border:0;display:flex;justify-content:center}hr:after{content:'';max-width:100px;width:100%;border:1px solid var(--gray-light)}.link{border-bottom:4px solid var(--accent)}.c-gray{color:var(--gray)}.bg-light{background:var(--highlight)}.font-normal{font-weight:400}.font-bold{font-weight:700}.font-16{font-size:1rem}.font-24{font-size:1.5rem}.font-32{font-size:2rem}.inline-block{display:inline-block}.inline-flex{display:inline-flex}.flex-x{display:flex;flex-direction:row}.flex-y{display:flex;flex-direction:column}.flex-1{flex:1}.align-right{margin-left:auto}.flex-row.center-y{align-items:center}.flex-col.center-y{justify-content:center}.flex-row.center-x{justify-content:center}.flex-col.center-x{align-items:center}.flex-x.center-y{align-items:center}.flex-y.center-y{justify-content:center}.flex-x.center-x{justify-content:center}.flex-y.center-x{align-items:center}.center{justify-content:center;align-items:center}.grid{display:grid;grid-template-columns:repeat(2,1fr);grid-gap:1rem;grid-auto-rows:1fr}.size-16{width:1rem;height:1rem}.size-20{width:1.25rem;height:1.25rem}.size-24{width:1.5rem;height:1.5rem}.size-32{width:2rem;height:2rem}.padx-8{padding-left:0.5rem;padding-right:0.5rem}.padx-16{padding-left:1rem;padding-right:1rem}.padx-32{padding-left:2rem;padding-right:2rem}.padx-64{padding-left:4rem;padding-right:4rem}.pady-8{padding-top:0.5rem;padding-bottom:0.5rem}.pady-16{padding-top:1rem;padding-bottom:1rem}.pady-32{padding-top:2rem;padding-bottom:2rem}.pady-64{padding-top:4rem;padding-bottom:4rem}.pad-8{padding:0.5rem}.pad-16{padding:1rem}.pad-32{padding:2rem}.pad-64{padding:4rem}.mary-32{margin-top:2rem;margin-bottom:2rem}.marb-32{margin-bottom:2rem}.w-full{width:100%}.w-1280{max-width:80rem;width:100%}.w-800{max-width:50rem;width:100%}.h-full{height:100%}.h-64{height:4rem}.h-128{height:8rem}.h-200{height:12.5rem}.h-320{height:20rem}.csx-8>*:not(:last-child){margin-right:0.5rem}.csx-16>*:not(:last-child){margin-right:1rem}.csx-32>*:not(:last-child){margin-right:2rem}.csx-64>*:not(:last-child){margin-right:4rem}.csy-8>*:not(:last-child){margin-bottom:0.5rem}.csy-16>*:not(:last-child){margin-bottom:1rem}.csy-32>*:not(:last-child){margin-bottom:2rem}.csy-64>*:not(:last-child){margin-bottom:4rem}.bg{position:absolute;z-index:-1;opacity:0.25}a:hover .bg{opacity:0.75}.cover{object-fit:cover;width:100%;height:100%}.content{max-width:44rem;margin:0 auto;width:100%}.content :is(h2,h3,h4,h5,h6){margin:2rem 0 0.5rem 0}.video{position:relative;padding-bottom:56.25%;height:0}.video iframe{position:absolute;top:0;left:0;width:100%;height:100%}.round{border-radius:2px}.round-2{border-radius:4px}.crop{overflow:hidden}.quote{border-radius:4px;background:#272822;color:#F8F8F2;font-weight:500;white-space:pre-line;padding:2rem;margin:2rem 0}.code,.inline_code{border-radius:4px;background:#272822;color:#F8F8F2;font-weight:500;font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}.inline_code{display:inline;padding:0.2rem 0.4rem}.code{overflow-x:auto;padding:2rem;margin:2rem 0}.tok-Keyword,.tok-Macro{color:#F92672}.tok-Type{color:#66D9EF}.tok-Comment{color:#75715E}.tok-Number,.tok-Literal{color:#AE81FF}.tok-String{color:#E6DB74 }.tok-Function{color:#A6E22E}@media screen and (max-width:640px){html{font-size:16px}}@media screen and (min-width:961px){html{font-size:18px}}@media screen and (min-width:1441px){html{font-size:20px}.xl\:h-480{height:30rem}}@media screen and (max-width:960px){.md\:flex-x{display:flex;flex-direction:row}.md\:flex-y{display:flex;flex-direction:column}.md\:csy-8>*:not(:last-child){margin-bottom:0.5rem}.md\:pad-32{padding:2rem}}@media screen and (max-width:640px){.sm\:flex-x{display:flex;flex-direction:row}.sm\:flex-y{display:flex;flex-direction:column}.sm\:csy-8>*:not(:last-child){margin-bottom:0.5rem}.sm\:pad-32{padding:2rem}.sm\:pad-16{padding:1rem}.sm\:padx-32{padding-left:2rem;padding-right:2rem}.sm\:h-160{height:11rem}.sm\:h-240{height:15rem}.grid{grid-template-columns:repeat(1,1fr)}}@media screen and (max-width:480px){.xs\:flex-y{display:flex;flex-direction:column}}</style>
<link rel='alternate' type='application/rss+xml' title='Nick Aversano' href='https://nickav.co/feed.xml' />
</head>
<body class='Why I Write C'>
<div class='content flex-x pad-64  xs:flex-y sm:csy-8 sm:pad-32'>
<div class='csx-16 flex-1 flex-x center-y'>
<span class='font-24 font-bold'><a href='/'>Nick Aversano</a></span>
</div>
<div class='csx-16 flex-x'>
<a title='Twitch' href='https://twitch.tv/naversano' target='_blank' class='inline-flex center pad-8'><div class='inline-block size-20'><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitch</title><path d="M11.571 4.714h1.715v5.143H11.57zm4.715 0H18v5.143h-1.714zM6 0L1.714 4.286v15.428h5.143V24l4.286-4.286h3.428L22.286 12V0zm14.571 11.143l-3.428 3.428h-3.429l-3 3v-3H6.857V1.714h13.714Z"/></svg></div></a>
<a title='Twitter' href='https://www.twitter.com/nickaversano' target='_blank' class='inline-flex center pad-8'><div class='inline-block size-20'><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/></svg></div></a>
<a title='Github' href='https://www.github.com/nickav' target='_blank' class='inline-flex center pad-8'><div class='inline-block size-20'><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></div></a>
</div>
</div>
<div class='w-full h-320 sm:h-240 xl:h-480 bg-light'>
<img src='/r/godrays_04.png' alt='' class='cover'/>
</div>
<div class='content padx-64 sm:padx-32 h-64 flex-x center-y csx-32' style='margin-bottom: -2rem'><a class='font-bold pady-16' href='/posts/0001_hello_world'>← Prev</a></div>
<div id='content' class='content pad-64 sm:pad-32'>
<div class='marb-32'>
<div class='c-gray' style='font-size:0.8rem'>4 min read</div>
<h1>Why I Write C</h1>
<div class='c-gray'>29 June 2023</div>
<div>By <a class='font-bold link' href='/'>Nick Aversano</a></div>
</div>

I started learning how to write my own game engines 5 years ago.
In doing so, I've learned a ton about how computers actually work.
C++ has been a great choice in many ways.
It has also been an extremely humbling choice—I've encountered many things I didn't understand.
Now I know some things, and I know that I don't know even more things.
There's always more to learn!
<p></p>Since the jQuery days, I had been doing frontend and backend web development.
I've written web backends in almost every language I know.
And I spent a ton of time writing React applications.
After writing many many "web apps" I started to feel overwhelmingly frustrated with the web ecosystem.
And with the trend of software in general.
There are: slow build times, projects with 10k+ dependencies all for a pretty crappy UX. Seems like a bad trade!
<p></p>The initial spark for writing my own engine came from the web, actually.
I wanted to get back into game development, but was extremely frustrated by the now 5+ second build times of Game Maker Studio.
I wondered if I could bring hot reloading from the web to game making?
My computer should be able to reload things instantly!
<p></p>I decided to use C because I knew that lots of game engines are written in C and C++.
I also knew that my code could run as fast as the hardware would allow.
If you want to prove that you learned something, explaining it to someone is a good test. Explaining it to a computer is even better.
<p></p>I also decided to take it one step further by not allowing myself to use many libraries.
I do use the C Runtime Library (CRT) and some third-party <a class='link' href='https://github.com/nothings/stb' target='_blank'>single-file header libraries</a>, but I try them to a minimum.
<p></p>What I learned to love about C is it gives you almost nothing.
You are in control of everything that happens.
You're just about as close to the computer as you can get without writing assembly code.
And you can even see the <a class='link' href='https://uops.info/table.html' target='_blank'>instructions</a> if you want to!
<p></p><blockquote class='quote'>As it turns out CPUs are more complicated these days, and there are things called micro-ops which some instructions break further down into. But let's not get into that here!</blockquote>Learning how to make game engines from scratch is also a great way to learn
how to build applications from scratch.
It's the <a class='link' href='https://handmade.network' target='_blank'>Handmade</a> ethos if you will.
Games have to do what every application on your computer needs to do. They need to open a window, get user input, display the results, and play sound.
And they have to run in 16ms per frame, every frame.
And they have to build a fun experience on top of that!
<p></p>At their core, games need to:
<p></p><ol><li>Get input from the outside world</li><li>Do some updates based on that input</li><li>Display the result to the user</li></ol><p></p><pre class='code'><span class='tok-Function'>GetInput</span>();
<span class='tok-Function'>Update</span>();
<span class='tok-Function'>Draw</span>();</pre><p></p>In practice, what this actually looks like is more like:
<p></p><pre class='code'><span class='tok-Type'>f64</span> then = <span class='tok-Function'>OS_Time</span>();

<span class='tok-Keyword'>while</span> (!<span class='tok-Function'>ShouldCloseApp</span>())
{
    <span class='tok-Type'>f64</span> now = <span class='tok-Function'>OS_Time</span>();
    <span class='tok-Type'>f64</span> delta_time = then - now;
    now = then;

    <span class='tok-Function'>GetInput</span>();
    <span class='tok-Function'>Update</span>(delta_time);
    <span class='tok-Function'>Draw</span>(delta_time);

    <span class='tok-Function'>WaitUntilNextFrame</span>();
}</pre><p></p>I mean, really more like <a class='link' href='https://gafferongames.com/post/fix_your_timestep/' target='_blank'>this timestep</a>. But hopefully you get the idea.
<p></p>Because I had to build everything myself, I had to learn how everything works from first principles.
I didn't write everything myself. I got lots of inspiration and code snippets from others.
The trick was finding a good balance between using what I knew and exploring what paths others had gone down.
<p></p>I eventually decided to write a base layer that I could build on top of.
Similar to what you would get in other programming languages.
And if something has a bug, that means I could fix it!
And if something has a bug, that means I have to fix it.
<p></p>This <a class='link' href='https://github.com/nickav/na/blob/master/na.h' target='_blank'>base layer</a> includes:
<ul><li>Basic types and macros</li><li>Arenas and allocators for memory management</li><li>Strings and Unicode conversions</li><li>File IO, dates and times</li><li>Threading primitives like semaphores and mutexes</li><li>Arrays and Tables</li></ul><p></p>I also built a core layer on top of the base layer that includes:
<ul><li>Math</li><li>Windows and mouse and keyboard input</li><li>Controller input</li><li>Graphics</li><li>Fonts</li><li>Audio</li><li>Sound mixing</li><li>Networking</li><li>Image reading and writing</li></ul><p></p>And finally the game itself typically includes:
<ul><li>An asset system</li><li>Hot reloading</li><li>Entities</li></ul><p></p>As it turns out, things at the operating system level get a little bit ticky.
The world is a mess of complexity and <a class='link' href='https://en.wikipedia.org/wiki/Conway%27s_law' target='_blank'>Conway's Law</a>.
Microsoft APIs are no exception:
<p></p><ul><li>Want to open a window? Well, there's a lot of quirks with that.</li><li>Want graphics to show up on the screen? You're going to have to wrangle GPU APIs (similar to doing your taxes). Or at the very least learn a lot about software rendering.</li><li>Want sounds? You need to really care about the speed of that! Not to mention sound mixing.</li><li>Want controller input? Well there's like 4 different Windows APIs and they all give different and overlapping information: XInput, DirectInput, Raw Input, ...</li><li>Want fonts? That's a rabbit hole. At the very least, you have to write a font-atlas and space out all the glyphs manually, not to mention dealing with other languages! And did I mention there are some right-to-left languages?</li></ul><p></p><hr/><p></p>You really appreciate everything when you have nothing.
<p></p>C gives you a first-principles mindset to problems in computing more generally.
In some sense, you know exactly what the hardware is doing.
Too many things are built on top of towers of abstractions, and it's harder to reason about what's actually going on.
Why do we do things the way we do them now?
Are we getting good results?
If not, why not?
<p></p>It seems like modern day programming is inundated with libraries, OOP, TDD, slowness, bad UX, and <a class='link' href='https://sneak.berlin/20201112/your-computer-isnt-yours/' target='_blank'>outright malicious</a> practices.
And there are lots of programmers who don't even try to get better.
They just repeat the same dogma. Maybe because it's all they know. Maybe they're scared of confronting what they don't know?
<p></p>I think it's safe to say that the software industry has massive problems today.
Programmers have failed.
Software continues to get slower and worse.
Users are increasingly being used for business profits with little or no care.
<p></p>Maybe as a culture we've also forgotten how fast computers used to be?
I certainly did!
I had forgotten how fast applications used to start up.
There were no load times, no updates while you try to open the thing, no restarts.
Things just worked better.
<p></p>Don't believe me? <a class='link' href='https://jmmv.dev/2023/06/fast-machines-slow-machines.html' target='_blank'>Check this out</a>.
<p></p>If we did literally did nothing, then software that is 20 years old should be 1000x faster today by <a class='link' href='https://en.wikipedia.org/wiki/De_Morgan%27s_laws' target='_blank'>De Morgan's Law</a>.
And yet, the software we use today is slower by <i>at least</i> an order of magnitude!
And that's being generous.
<p></p>So maybe we need to change our mindset?
<p></p>Maybe we need to start caring?
<p></p>Maybe we need to stop using so many goddamn dependencies.
<p></p>We need to count in milliseconds, not seconds.
<p></p>We need to get back to the basics.
<p></p>And that is why I write C.
<p></p><hr/><p></p>I still encounter many things I don't understand and probably always will.
But I've learned that I can learn anything with enough time and practice.
It's okay to get inspiration from others, but try not to worry about exactly how others solved their problems.
Solve it for yourself.
Start where you are, use what you have, do what you can.
And remember to be kind to yourself!
</div>
<div class='content pad-64 w-800 sm:pad-32 flex-y center-x'>
<a class='pad-16' onclick='toggle()'>💡</a>
<div style='min-width: 64px; max-width: 64px; margin-bottom: -64px'>
<img src='/r/guy_pixel.png' alt='Guy'  style='image-rendering:pixelated;'/>
</div>
</div>
<script>var invert = false;const up = (i) => {try { localStorage.setItem('invert', i ? 1 : 0); } catch(err) {}document.body.classList.toggle('invert', i);invert = i;};function toggle(){up(!invert);}if (window.matchMedia){try { i = localStorage.getItem('invert'); } catch(err) {}if (i === null) i = !window.matchMedia('(prefers-color-scheme: dark)').matches;else i = !!Number(i);up(i);window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {up(!e.matches, true);});}window.addEventListener('load', () => {document.getElementsByTagName('html')[0].className += 'load';});</script>
<script src='/lightning.js'></script>
</body>
</html>
